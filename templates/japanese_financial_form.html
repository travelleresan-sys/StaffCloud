<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è²¡å‹™è«¸è¡¨ä½œæˆ - è²¡å‹™è«¸è¡¨Excelå‡ºåŠ›ã‚·ã‚¹ãƒ†ãƒ </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
                <div class="text-center mb-4">
                    <h1 class="h2 text-primary">
                        <i class="bi bi-file-earmark-excel me-2"></i>
                        è²¡å‹™è«¸è¡¨ä½œæˆ
                    </h1>
                    <p class="text-muted">ä¼šç¤¾æƒ…å ±ã‚’å…¥åŠ›ã—ã¦Excelå½¢å¼ã®è²¡å‹™è«¸è¡¨ã‚’ç”Ÿæˆã—ã¾ã™</p>
                </div>

                <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }} alert-dismissible fade show" role="alert">
                                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                <!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0">
                            <i class="bi bi-building me-2"></i>
                            ä¼šç¤¾æƒ…å ±å…¥åŠ›
                        </h4>
                    </div>
                    <div class="card-body">
                        <form method="POST" id="financialForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="company_name" class="form-label">
                                            <i class="bi bi-building me-1"></i>
                                            ä¼šç¤¾å <span class="text-danger">*</span>
                                        </label>
                                        <input type="text"
                                               class="form-control"
                                               id="company_name"
                                               name="company_name"
                                               value="æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«"
                                               required>
                                        <div class="form-text">ä¾‹ï¼šæ ªå¼ä¼šç¤¾â—‹â—‹â—‹</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="fiscal_year" class="form-label">
                                            <i class="bi bi-calendar me-1"></i>
                                            æ±ºç®—å¹´åº¦ <span class="text-danger">*</span>
                                        </label>
                                        <select class="form-select" id="fiscal_year" name="fiscal_year" required>
                                            {% for year in range(2020, 2030) %}
                                                <option value="{{ year }}" {% if year == 2025 %}selected{% endif %}>
                                                    {{ year }}å¹´3æœˆæœŸ
                                                </option>
                                            {% endfor %}
                                        </select>
                                        <div class="form-text">è²¡å‹™è«¸è¡¨ã®å¯¾è±¡å¹´åº¦</div>
                                    </div>
                                </div>
                            </div>

                            <!-- å‡ºåŠ›å†…å®¹èª¬æ˜ -->
                            <div class="alert alert-info">
                                <h6 class="alert-heading">
                                    <i class="bi bi-info-circle me-2"></i>
                                    å‡ºåŠ›ã•ã‚Œã‚‹è²¡å‹™è«¸è¡¨ï¼ˆæ··åˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–æ¸ˆã¿ï¼‰
                                </h6>
                                <div class="row small">
                                    <div class="col-md-6">
                                        <ul class="mb-0">
                                            <li>è²¸å€Ÿå¯¾ç…§è¡¨ï¼ˆæµå‹•ãƒ»å›ºå®šåŒºåˆ†ï¼‰</li>
                                            <li>æç›Šè¨ˆç®—æ›¸ï¼ˆæ®µéšåˆ©ç›Šè¡¨ç¤ºï¼‰</li>
                                            <li>ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼è¨ˆç®—æ›¸</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <ul class="mb-0">
                                            <li>æ ªä¸»è³‡æœ¬ç­‰å¤‰å‹•è¨ˆç®—æ›¸</li>
                                            <li>é™„å±æ˜ç´°æ›¸ï¼ˆä¼šè¨ˆæ–¹é‡ãƒ»æ˜ç´°ï¼‰</li>
                                        </ul>
                                    </div>
                                </div>
                                <hr>
                                <small class="text-muted">
                                    <i class="bi bi-printer me-1"></i>
                                    <strong>æ··åˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–:</strong>
                                    <br>
                                    ğŸ“„ A4ç¸¦å‘ã‘: è²¸å€Ÿå¯¾ç…§è¡¨ãƒ»æç›Šè¨ˆç®—æ›¸ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼è¨ˆç®—æ›¸
                                    <br>
                                    ğŸ“„ A4æ¨ªå‘ã‘: æ ªä¸»è³‡æœ¬ç­‰å¤‰å‹•è¨ˆç®—æ›¸ãƒ»é™„å±æ˜ç´°æ›¸ï¼ˆè©³ç´°è¡¨ç¤ºï¼‰
                                    <br>
                                    <i class="bi bi-lightbulb me-1"></i>
                                    å„ã‚·ãƒ¼ãƒˆã«ã¯æ—¥æœ¬ã®ä¼šè¨ˆåŸºæº–ã«æº–æ‹ ã—ãŸã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã¾ã™
                                </small>
                            </div>

                            <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <a href="{{ url_for('index') }}" class="btn btn-outline-secondary me-md-2">
                                    <i class="bi bi-arrow-left me-1"></i>
                                    æˆ»ã‚‹
                                </a>
                                <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                                    <i class="bi bi-download me-2"></i>
                                    <span id="btnText">è²¡å‹™è«¸è¡¨Excelç”Ÿæˆãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</span>
                                    <span id="loadingSpinner" class="spinner-border spinner-border-sm ms-2 d-none" role="status">
                                        <span class="visually-hidden">ç”Ÿæˆä¸­...</span>
                                    </span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- åˆ©ç”¨ä¸Šã®æ³¨æ„ -->
                <div class="card mt-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            åˆ©ç”¨ä¸Šã®æ³¨æ„
                        </h5>
                    </div>
                    <div class="card-body">
                        <ul class="mb-0">
                            <li>ç”Ÿæˆã•ã‚Œã‚‹è²¡å‹™è«¸è¡¨ã«ã¯ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã¾ã™</li>
                            <li>å®Ÿéš›ã®ä¼šè¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€ãƒ‡ãƒ¼ã‚¿å…¥åŠ›æ©Ÿèƒ½ãŒå¿…è¦ã§ã™</li>
                            <li>ä¼šè¨ˆå‡¦ç†ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä¼šè¨ˆå£«ç­‰ã®å°‚é–€å®¶ã«ã”ç›¸è«‡ãã ã•ã„</li>
                            <li>Excelå½¢å¼ï¼ˆ.xlsxï¼‰ã§å‡ºåŠ›ã•ã‚Œã¾ã™ï¼ˆMicrosoft Excel 2007ä»¥é™å¯¾å¿œï¼‰</li>
                        </ul>
                    </div>
                </div>

                <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
                <div class="text-center mt-4 text-muted">
                    <p><small>Â© 2025 è²¡å‹™è«¸è¡¨Excelå‡ºåŠ›ã‚·ã‚¹ãƒ†ãƒ </small></p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
        document.getElementById('financialForm').addEventListener('submit', function() {
            const submitBtn = document.getElementById('submitBtn');
            const btnText = document.getElementById('btnText');
            const loadingSpinner = document.getElementById('loadingSpinner');

            submitBtn.disabled = true;
            btnText.textContent = 'ç”Ÿæˆä¸­...';
            loadingSpinner.classList.remove('d-none');
        });

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–ï¼ˆæˆ»ã‚‹ç­‰ã§æˆ»ã£ã¦ããŸå ´åˆï¼‰
        window.addEventListener('load', function() {
            const submitBtn = document.getElementById('submitBtn');
            const btnText = document.getElementById('btnText');
            const loadingSpinner = document.getElementById('loadingSpinner');

            submitBtn.disabled = false;
            btnText.textContent = 'è²¡å‹™è«¸è¡¨Excelç”Ÿæˆãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰';
            loadingSpinner.classList.add('d-none');
        });
    </script>
</body>
</html>